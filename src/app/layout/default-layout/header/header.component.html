<!-- header.component.html -->
<header class="main-header header-style-three">
  <!-- Header Lower -->
  <div class="header-lower">
    <div class="outer-container">
      <div class="left-column">
        <!-- Logo Box -->
        <div class="logo-box">
          <a routerLink="/home">
            <div class="header-logo"></div>
          </a>
        </div>

        <!-- Menu Area -->
        <div class="menu-area">
          <!-- Mobile Navigation Toggler -->
          <div class="mobile-nav-toggler d-lg-none">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </div>

          <!-- Main Menu -->
          <nav class="main-menu navbar-expand-lg">
            <div class="navbar-collapse show clearfix" id="navbarSupportedContent">
              <ul class="navigation clearfix">
                <li><a routerLink="/home">Home</a></li>
                <li><a routerLink="/collection">Collection</a></li>
                <li><a routerLink="/membersNews">News</a></li>
                <li><a routerLink="/membersEvents">Events</a></li>
                <li><a routerLink="/membersTeam">Team</a></li>
                <li><a routerLink="/about">Contact</a></li>
              </ul>
            </div>
          </nav>
        </div>
      </div>

      <!-- Right Menu Content -->
      <div class="menu-right-content">
        <!-- Notification Bell -->
        <div class="notification-dropdown" *ngIf="isLoggedIn">
          <div class="notification-icon-wrapper" (click)="toggleNotificationDropdown()">
            <svg width="24" height="24" viewBox="0 0 512 512">
              <g>
                <g>
                  <g>
                    <path class="notification-icon" d="M65.192,272.872c-3.979-4.342-10.727-4.641-15.071-0.659c-1.233,1.13-2.509,2.27-3.825,3.427
                      c-4.425,3.888-4.862,10.627-0.975,15.053c2.111,2.401,5.056,3.628,8.019,3.628c2.5,0,5.01-0.874,7.036-2.653
                      c1.431-1.257,2.817-2.498,4.156-3.726C68.876,283.963,69.172,277.215,65.192,272.872z"/>
                    <path class="notification-icon" d="M72.339,265.417c1.856,1.292,3.979,1.913,6.083,1.913c3.373,0,6.692-1.597,8.765-4.575
                      c17.563-25.238,20.206-50.18,23.705-95.725c0.452-5.874-3.943-11.002-9.819-11.453c-5.891-0.451-11.001,3.946-11.452,9.819
                      c-3.296,42.902-5.519,64.445-19.943,85.174C66.309,255.404,67.503,262.053,72.339,265.417z"/>
                    <path class="notification-icon" d="M398.336,147.832c1.069,5.012,5.495,8.446,10.422,8.446c0.735,0,1.484-0.077,2.234-0.237
                      c5.76-1.228,9.438-6.894,8.208-12.655c-0.439-2.064-0.925-4.142-1.442-6.177c-1.452-5.709-7.259-9.162-12.966-7.71
                      c-5.709,1.452-9.161,7.257-7.709,12.966C397.532,144.233,397.954,146.039,398.336,147.832z"/>
                    <path class="notification-icon" d="M465.484,275.453c-31.224-25.969-38.083-51.269-42.433-101.768c-0.507-5.87-5.679-10.221-11.543-9.711
                      c-5.869,0.506-10.217,5.674-9.711,11.542c4.698,54.531,13.383,85.849,50.046,116.339c1.994,1.658,4.411,2.466,6.815,2.466
                      c3.06,0,6.098-1.31,8.208-3.846C470.632,285.945,470.013,279.22,465.484,275.453z"/>
                    <path class="notification-icon" d="M441.904,314.239c-0.142-0.284-0.295-0.559-0.463-0.828c-2.579-4.601-5.867-8.114-9.823-10.396
                      c-28.787-16.613-46.208-61.816-51.781-134.352c-4.133-53.8-42.494-97.895-92.406-111.187c3.738-5.813,5.915-12.72,5.915-20.129
                      C293.347,16.754,276.592,0,255.998,0c-20.592,0-37.346,16.754-37.346,37.348c0,7.409,2.179,14.315,5.915,20.129
                      c-49.912,13.291-88.273,57.387-92.408,111.187c-5.573,72.536-22.994,117.738-51.779,134.352
                      c-8.337,4.811-13.755,15.027-15.665,29.548c-1.239,9.426-1.621,29.217,5.817,36.649c2,1.999,4.713,3.122,7.539,3.122h113.823
                      c5.104,30.781,31.9,54.332,64.107,54.332c32.206,0,59.001-23.551,64.107-54.332h113.821c2.827,0,5.539-1.123,7.539-3.122
                      c7.44-7.437,7.056-27.234,5.814-36.663C446.33,325.338,444.513,319.191,441.904,314.239z M255.998,21.333
                      c8.831,0,16.015,7.184,16.015,16.015c0,8.83-7.183,16.014-16.015,16.014c-8.829,0-16.013-7.184-16.013-16.014
                      C239.986,28.517,247.17,21.333,255.998,21.333z M255.998,405.333c-20.398,0-37.569-14.061-42.341-32.998h84.681
                      C293.567,391.272,276.396,405.333,255.998,405.333z M426.234,351.002H85.763c-0.442-3.487-0.675-8.542-0.067-14.235
                      c1.021-9.532,3.756-14.356,5.346-15.275c35.748-20.631,56.156-70.087,62.387-151.194c4.118-53.609,49.173-95.603,102.568-95.603
                      c53.396,0,98.45,41.995,102.568,95.603c2.998,39.019,9.285,70.691,18.975,95.374h-40.1c-5.889,0-10.667,4.775-10.667,10.667
                      s4.778,10.667,10.667,10.667h50.323c4.822,8.249,10.221,15.35,16.197,21.333H297.596c-5.889,0-10.667,4.775-10.667,10.667
                      c0,5.891,4.778,10.667,10.667,10.667H425.05c0.512,1.988,0.953,4.338,1.248,7.093
                      C426.909,342.459,426.675,347.514,426.234,351.002z"/>
                    <path class="notification-icon" d="M362.663,490.667l-213.333-0.004c-5.889,0-10.667,4.775-10.667,10.667c0,5.89,4.775,10.667,10.667,10.667L362.663,512
                      c5.891,0,10.667-4.775,10.667-10.667S368.555,490.667,362.663,490.667z"/>
                    <path class="notification-icon" d="M259.198,308.339h-6.4c-5.891,0-10.667,4.775-10.667,10.667c0,5.891,4.775,10.667,10.667,10.667h6.4
                      c5.889,0,10.667-4.775,10.667-10.667C269.865,313.114,265.088,308.339,259.198,308.339z"/>
                  </g>
                </g>
              </g>
            </svg>
            <span class="notification-badge" *ngIf="unreadNotifications > 0">{{unreadNotifications}}</span>
          </div>

          <!-- Notification dropdown menu -->
          <ul class="dropdown-menu notification-menu" [class.show]="showNotificationDropdown">
            <li class="dropdown-header">
              <div class="d-flex justify-content-between align-items-center">
                <div>
                  <span>Notifications</span>
                  <span class="unread-count" *ngIf="unreadNotifications > 0">{{unreadNotifications}} unread</span>
                </div>
                <button 
                  *ngIf="notifications.length > 0 && unreadNotifications > 0"
                  class="btn btn-sm btn-outline-primary mark-all-read-btn"
                  (click)="markAllAsRead(); $event.stopPropagation()"
                  title="Mark All as Read">
                  Mark All Read
                </button>
              </div>
            </li>
            <li *ngFor="let notification of notifications" 
                class="notification-item"
                [class.unread]="!notification.is_read"
                (click)="handleNotificationClick(notification)">
              <div class="notification-content">
                <div class="notification-title">{{notification.title}}</div>
                <div class="notification-message">{{notification.message}}</div>
                <div class="notification-time">{{notification.createdAt | date:'short'}}</div>
                <div *ngIf="notification.related_booking" class="notification-action">
                  Click to view booking details
                </div>
              </div>
            </li>
            <li *ngIf="notifications.length === 0" class="no-notifications">
              <span>No notifications</span>
            </li>

          </ul>
        </div>

        <div class="user-profile-dropdown">
          <!-- Clickable user icon -->
          <div class="user-icon-wrapper" (click)="toggleUserDropdown()">
            <svg width="24" height="24" viewBox="0 0 24 24">
              <path class="user-icon" fill-rule="evenodd" d="M12 4a4 4 0 1 0 0 8 4 4 0 0 0 0-8Zm-2 9a4 4 0 0 0-4 4v1a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2v-1a4 4 0 0 0-4-4h-4Z" clip-rule="evenodd"/>
            </svg>
          </div>

          <!-- Click-to-show dropdown menu -->
          <ul class="dropdown-menu" [class.show]="isUserDropdownOpen">
            <li><a class="dropdown-item" routerLink="/profile" (click)="onMenuItemClick()">Profile</a></li>
            <li><a class="dropdown-item" routerLink="/membership" (click)="onMenuItemClick()">Memberships</a></li>
            <li><a class="dropdown-item" routerLink="/orders" (click)="onMenuItemClick()">Bookings</a></li>
            <li><a class="dropdown-item" (click)="logout()" style="cursor: pointer;">Logout</a></li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</header>
